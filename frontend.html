<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phishing Email Detector</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .spinner {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>

<body class="bg-gradient-to-br from-indigo-50 via-white to-blue-50 min-h-screen py-10">

    <div class="max-w-5xl mx-auto px-4">

        <!-- HEADER -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6 flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">Phishing Email Detector</h1>
                <p class="text-gray-600">AI-Powered Email Security Analysis by Amitabh</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-500">Model Accuracy</p>
                <p class="text-3xl font-bold text-green-600">95.71%</p>
            </div>
        </div>

        <!-- MAIN PANEL -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-2 flex items-center gap-2">
                üìß Email Content Analysis
            </h2>

            <textarea
                id="emailContent"
                class="w-full h-52 p-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"
                placeholder="Paste the email content you want to analyze..."
            ></textarea>

            <div class="flex gap-3 mt-4">
                <button
                    onclick="analyzeEmail()"
                    id="analyzeBtn"
                    class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2"
                >
                    Analyze Email
                </button>

                <button
                    onclick="resetInput()"
                    class="px-5 py-3 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium text-gray-700"
                >
                    Reset
                </button>
            </div>

            <!-- Results -->
            <div id="resultBox" class="hidden mt-6 p-6 rounded-xl border-2 bg-gradient-to-r from-gray-50 to-blue-50"></div>
        </div>

        <!-- MODEL PERFORMANCE -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">üìä Model Performance</h3>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div>
                    <p class="text-sm text-gray-500">Accuracy</p>
                    <p class="text-xl font-bold text-indigo-600">95.71%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Precision</p>
                    <p class="text-xl font-bold text-indigo-600">93.99%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Recall</p>
                    <p class="text-xl font-bold text-indigo-600">95.14%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">F1 Score</p>
                    <p class="text-xl font-bold text-indigo-600">94.56%</p>
                </div>
            </div>

            <p class="text-xs text-gray-400 mt-3">Model: Logistic Regression | Dataset size: 18,634 emails</p>
        </div>

        <!-- SECURITY TIPS -->
        <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 shadow-md">
            <h3 class="text-lg font-semibold mb-3 text-gray-800">‚ö†Ô∏è Common Phishing Red Flags</h3>
            <ul class="space-y-2 text-gray-700">
                <li>‚Ä¢ Urgent or threatening language</li>
                <li>‚Ä¢ Requests for financial or login info</li>
                <li>‚Ä¢ Suspicious links or attachments</li>
                <li>‚Ä¢ Unexpected sender or generic greetings</li>
                <li>‚Ä¢ Poor grammar or spelling errors</li>
            </ul>
        </div>

        <p class="text-center text-xs text-gray-500 mt-6">
            Powered by Amitabh's Machine Learning Model
        </p>
    </div>

<script>
async function analyzeEmail() {
    const email = document.getElementById("emailContent").value.trim();
    const btn = document.getElementById("analyzeBtn");
    const resultBox = document.getElementById("resultBox");

    if (!email) {
        alert("Please enter email content to analyze");
        return;
    }

    // Spinner
    btn.innerHTML = '<div class="spinner"></div> Analyzing...';
    btn.disabled = true;

    try {
        const response = await fetch("https://phishing-backend-axca.onrender.com/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email: email })
        });

        const data = await response.json();
        resultBox.classList.remove("hidden");

        const isPhishing = data.prediction === 1 || data.label === "phishing";

        resultBox.innerHTML = `
            <h3 class="text-xl font-bold mb-3 ${isPhishing ? 'text-red-600' : 'text-green-600'}">
                ${isPhishing ? "üö® Phishing Detected" : "‚úÖ Safe Email"}
            </h3>
            <p class="text-gray-700 text-lg font-medium">
                Confidence: ${(isPhishing ? data.phishing_prob : data.safe_prob).toFixed(2)}%
            </p>

            <div class="mt-4">
                <p class="font-semibold text-gray-700">Indicators:</p>
                <ul class="list-disc ml-6 text-gray-600">
                    ${
                        isPhishing
                        ? "<li>Suspicious wording detected</li><li>Matches phishing patterns in the dataset</li>"
                        : "<li>No strong phishing characteristics detected</li>"
                    }
                </ul>
            </div>
        `;

    } catch (err) {
        console.error(err);
        alert("Error contacting backend: " + err);
    }

    btn.innerHTML = "Analyze Email";
    btn.disabled = false;
}

function resetInput() {
    document.getElementById("emailContent").value = "";
    document.getElementById("resultBox").classList.add("hidden");
}
</script>

</body>
</html>
