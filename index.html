<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard AI</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .spinner {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>

<body class="bg-gradient-to-br from-indigo-50 via-white to-blue-50 min-h-screen py-10">

    <div class="max-w-5xl mx-auto px-4">

        <!-- HEADER -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6 flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">PhishGuard AI</h1>
                <p class="text-gray-600">AI-Powered Phishing Email Detector</p>
            </div>

            <div class="text-right">
                <p class="text-sm text-gray-500">Model Accuracy</p>
                <p class="text-3xl font-bold text-green-600">95.71%</p>

                <button onclick="openModelModal()" 
                    class="mt-2 text-xs px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg border border-indigo-300 hover:bg-indigo-200">
                    Model Info
                </button>
            </div>
        </div>

        <!-- MAIN PANEL -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-2 flex items-center gap-2">
                üìß Email Content Analysis
            </h2>

            <!-- SAMPLE EMAIL BUTTONS -->
            <div class="flex gap-3 mb-4">
                <button onclick="loadSample('phishing')" 
                    class="text-sm bg-red-50 text-red-700 px-4 py-2 rounded-lg border border-red-200 hover:bg-red-100">
                    Load Phishing Sample
                </button>

                <button onclick="loadSample('safe')" 
                    class="text-sm bg-green-50 text-green-700 px-4 py-2 rounded-lg border border-green-200 hover:bg-green-100">
                    Load Safe Sample
                </button>

                <button onclick="loadSample('suspicious')" 
                    class="text-sm bg-yellow-50 text-yellow-700 px-4 py-2 rounded-lg border border-yellow-200 hover:bg-yellow-100">
                    Load Suspicious Sample
                </button>
            </div>

            <textarea
                id="emailContent"
                class="w-full h-52 p-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"
                placeholder="Paste the email content you want to analyze..."
            ></textarea>

            <div class="flex gap-3 mt-4">
                <button
                    onclick="analyzeEmail()"
                    id="analyzeBtn"
                    class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2"
                >
                    Analyze Email
                </button>

                <button
                    onclick="resetInput()"
                    class="px-5 py-3 bg-gray-100 hover:bg-gray-200 rounded-xl font-medium text-gray-700"
                >
                    Reset
                </button>
            </div>

            <!-- Results -->
            <div id="resultBox" class="hidden mt-6 p-6 rounded-xl border-2 bg-gradient-to-r from-gray-50 to-blue-50"></div>
        </div>

        <!-- MODEL PERFORMANCE -->
        <div class="bg-white shadow-lg rounded-2xl p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Model Performance</h3>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div>
                    <p class="text-sm text-gray-500">Accuracy</p>
                    <p class="text-xl font-bold text-indigo-600">95.71%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Precision</p>
                    <p class="text-xl font-bold text-indigo-600">93.99%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">Recall</p>
                    <p class="text-xl font-bold text-indigo-600">95.14%</p>
                </div>
                <div>
                    <p class="text-sm text-gray-500">F1 Score</p>
                    <p class="text-xl font-bold text-indigo-600">94.56%</p>
                </div>
            </div>

            <p class="text-xs text-gray-400 mt-3">Model: Logistic Regression | Dataset size: 18,634 emails</p>
        </div>

        <!-- SECURITY TIPS -->
        <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 shadow-md">
            <h3 class="text-lg font-semibold mb-3 text-gray-800">‚ö†Ô∏è Common Phishing Red Flags</h3>
            <ul class="space-y-2 text-gray-700">
                <li>‚Ä¢ Urgent or threatening language</li>
                <li>‚Ä¢ Requests for financial or login info</li>
                <li>‚Ä¢ Suspicious links or attachments</li>
                <li>‚Ä¢ Unexpected sender or generic greetings</li>
                <li>‚Ä¢ Poor grammar or spelling errors</li>
            </ul>
        </div>

        <p class="text-center text-xs text-gray-500 mt-6">
            Designed and defended by Amitabh‚Äôs Cyber-AI Lab
        </p>
    </div>

<!-- MODEL INFO MODAL -->
<div id="modelModal" class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-xl max-w-lg w-full">
        <h2 class="text-2xl font-bold mb-3 text-gray-800">Model Information</h2>

        <p class="text-gray-700 mb-2"><strong>Algorithm:</strong> Logistic Regression</p>
        <p class="text-gray-700 mb-2"><strong>Dataset Size:</strong> 18,634 labeled emails</p>
        <p class="text-gray-700 mb-2"><strong>Training Features:</strong> TF-IDF (unigrams + bigrams)</p>
        <p class="text-gray-700 mb-2"><strong>Evaluation:</strong> 95.71% Accuracy, 94.56% F1 Score</p>

        <button onclick="closeModelModal()" 
            class="mt-4 w-full py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
            Close
        </button>
    </div>
</div>

<script>
/* --- SAMPLE EMAILS --- */
const samples = {
    phishing: `URGENT: Your account has been suspended.
Click the link below immediately to verify your identity:
http://malicious-login.com/verify
Failure to act will result in permanent account closure.`,

    safe: `Hi Team,
Just a reminder that the Q4 project meeting is scheduled for Tuesday.
Let me know if you need any documents beforehand.
Best,
John`,

    suspicious: `Hello user,
Your mailbox storage is almost full.
Click the following link to increase your quota:
http://unknown-service.com/upgrade`
};

function loadSample(type) {
    document.getElementById("emailContent").value = samples[type];
}

/* --- ANALYSIS --- */
async function analyzeEmail() {
    const email = document.getElementById("emailContent").value.trim();
    const btn = document.getElementById("analyzeBtn");
    const resultBox = document.getElementById("resultBox");

    if (!email) return alert("Please enter email content to analyze");

    btn.innerHTML = '<div class="spinner"></div> Analyzing...';
    btn.disabled = true;

    try {
        const response = await fetch("https://phishing-backend-axca.onrender.com/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email })
        });

        const data = await response.json();
        const isPhishing = data.prediction === 1;

        /* --- NLP INDICATORS --- */
        const indicators = [];
        const lower = email.toLowerCase();

        if (lower.includes("verify") || lower.includes("confirm"))
            indicators.push("Verification request detected");
        if (lower.includes("urgent") || lower.includes("immediately"))
            indicators.push("Urgency / pressure language detected");
        if (email.includes("http://") || email.includes("https://"))
            indicators.push("Presence of external links");
        if (email.length < 40)
            indicators.push("Email unusually short (possible scam)");

        const indicatorList = indicators.length
            ? indicators.map(i => `<li>${i}</li>`).join("")
            : "<li>No major phishing indicators detected</li>";

        resultBox.classList.remove("hidden");

        /* --- UI RESULT BLOCK --- */
        resultBox.innerHTML = `
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-bold ${isPhishing ? 'text-red-600' : 'text-green-600'}">
                    ${isPhishing ? "üö® Phishing Detected" : "‚úÖ Safe Email"}
                </h3>

                <span class="px-3 py-1 text-sm font-semibold rounded-lg 
                    ${isPhishing ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}">
                    ${isPhishing ? "High Risk" : "Low Risk"}
                </span>
            </div>

            <p class="text-gray-700 mb-2"><strong>Confidence Score</strong></p>

            <div class="w-full bg-gray-200 rounded-full h-3 mb-3">
                <div class="h-3 rounded-full transition-all duration-500 
                ${isPhishing ? 'bg-red-500' : 'bg-green-500'}" 
                    style="width: ${isPhishing ? data.phishing_prob : data.safe_prob}%">
                </div>
            </div>

            <p class="text-gray-700 mb-4">
                ${(isPhishing ? data.phishing_prob : data.safe_prob)}% confidence this email is 
                <strong>${isPhishing ? "phishing" : "safe"}</strong>.
            </p>

            <p class="font-semibold text-gray-700 mb-2">Detected Indicators:</p>
            <ul class="list-disc ml-6 text-gray-600">
                ${indicatorList}
            </ul>
        `;

    } catch (err) {
        alert("Error contacting backend.");
    }

    btn.innerHTML = "Analyze Email";
    btn.disabled = false;
}

/* --- RESET --- */
function resetInput() {
    document.getElementById("emailContent").value = "";
    document.getElementById("resultBox").classList.add("hidden");
}

/* --- MODAL CONTROLS --- */
function openModelModal() {
    const modal = document.getElementById("modelModal");
    modal.classList.remove("hidden");
    modal.classList.add("flex");
}

function closeModelModal() {
    document.getElementById("modelModal").classList.add("hidden");
}
</script>

</body>
</html>
